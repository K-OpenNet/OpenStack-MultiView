package chainlinker;

public class SnapIOStatParser extends SnapPluginParser {

	public SnapIOStatParser() {
		// All these data forms must be updated when snap publisher's output format is changed.
		
		typeMap.put("/intel/linux/iostat/avg-cpu/%user", lfClass);
		typeMap.put("/intel/linux/iostat/avg-cpu/%nice", lfClass);
		typeMap.put("/intel/linux/iostat/avg-cpu/%system", lfClass);
		typeMap.put("/intel/linux/iostat/avg-cpu/%iowait", lfClass);
		typeMap.put("/intel/linux/iostat/avg-cpu/%steal", lfClass);
		typeMap.put("/intel/linux/iostat/avg-cpu/%idle", lfClass);
		
		// Pattern: /intel/psutil/net/(alphanumerical(lowercase only) or _ or .)/(bytes_recv or bytes_sent or packets_recv or packets_sent)
		regexTypeMap.put("^\\/intel\\/psutil\\/net\\/([0-9]|[a-z]|_|\\.)*\\/(bytes_recv|bytes_sent|dropin|dropout|errin|errout|packets_recv|packets_sent)$", lClass);
		// Pattern: /intel/psutil/cpu/cpu(numerical not starting with 0 or 0 itself.)/(bytes_recv or bytes_sent or packets_recv or packets_sent)
		// regexTypeMap.put("^\\/intel\\/psutil\\/cpu\\/cpu(0|[0-9][0-9]*)\\/(guest|guest_nice|idle|iowait|irq|nice|softirq|steal|stolen|system|user)$", lfClass);
		// Currently "idle" value is given as null. Snap plugin is broken.
		regexTypeMap.put("^\\/intel\\/psutil\\/cpu\\/cpu(0|[0-9][0-9]*)\\/(guest|guest_nice|iowait|irq|nice|softirq|steal|stolen|system|user)$", lfClass);
		
		regexSet = regexTypeMap.keySet();
	}

}
